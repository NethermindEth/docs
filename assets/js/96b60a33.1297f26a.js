"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9842],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,f=u["".concat(l,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(f,i(i({ref:t},p),{},{components:n})):a.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},464:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={description:"Description of all possible options, their pros and cons"},i="How to reduce database size",s={unversionedId:"fundamentals/how-to-reduce-database-size/README",id:"fundamentals/how-to-reduce-database-size/README",title:"How to reduce database size",description:"Description of all possible options, their pros and cons",source:"@site/docs/02-fundamentals/08-how-to-reduce-database-size/README.md",sourceDirName:"02-fundamentals/08-how-to-reduce-database-size",slug:"/fundamentals/how-to-reduce-database-size/",permalink:"/docs/fundamentals/how-to-reduce-database-size/",draft:!1,editUrl:"https://github.com/NethermindEth/docs/tree/main/docs/docs/02-fundamentals/08-how-to-reduce-database-size/README.md",tags:[],version:"current",frontMatter:{description:"Description of all possible options, their pros and cons"},sidebar:"tutorialSidebar",previous:{title:"How to reduce the size of the database",permalink:"/docs/category/how-to-reduce-the-size-of-the-database"},next:{title:"Full Pruning",permalink:"/docs/fundamentals/how-to-reduce-database-size/full-pruning"}},l={},d=[],p={toc:d},u="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-reduce-database-size"},"How to reduce database size"),(0,r.kt)("p",null,"The Nethermind database can experience substantial growth over time, starting from an initial size of approximately 650\nGB. As a result, many node-setups are configured to run on 1TB disks. However, even with the application of settings\ndesigned to slow the growth rate, these disks may eventually run out of free space."),(0,r.kt)("p",null,"Current options to reduce db size are:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/docs/fundamentals/how-to-reduce-database-size/resync-database-from-scratch"},"Re-sync database from scratch")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/docs/fundamentals/how-to-reduce-database-size/full-pruning"},"Full pruning"))),(0,r.kt)("p",null,"The table below presents a short comparison of these methods including possible fine-tuning of each method. Data was\nfetched from a node running on a machine with the below specifications:\\\n\\\n",(0,r.kt)("strong",{parentName:"p"},"Node Version"),": 1.18.0\\\n",(0,r.kt)("strong",{parentName:"p"},"Consensus Client"),": Lighthouse\\\n",(0,r.kt)("strong",{parentName:"p"},"CPU"),": AMD EPYC 7713 64-Core Processor (16 cores allocated for this VM)\\\n",(0,r.kt)("strong",{parentName:"p"},"RAM"),": 64GB\\\n",(0,r.kt)("strong",{parentName:"p"},"Disk Size"),": 1.2 TB\\\n",(0,r.kt)("strong",{parentName:"p"},"IOPS of the disk","*"),": 70,000 - 80,000 IOPS (results vary in this range)"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Metric"),(0,r.kt)("th",{parentName:"tr",align:null},"Resync"),(0,r.kt)("th",{parentName:"tr",align:null},"Full Pruning"),(0,r.kt)("th",{parentName:"tr",align:null},"Full Pruning + Memory Budget (4 GB)"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Time of execution")),(0,r.kt)("td",{parentName:"tr",align:null},"~4h"),(0,r.kt)("td",{parentName:"tr",align:null},"~24h"),(0,r.kt)("td",{parentName:"tr",align:null},"~12h")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Minimum free disk space")),(0,r.kt)("td",{parentName:"tr",align:null},"N/A - you can execute resync even if there is 0 free space (avoid such case)"),(0,r.kt)("td",{parentName:"tr",align:null},"250 GB"),(0,r.kt)("td",{parentName:"tr",align:null},"250 GB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Attestation rate drop")),(0,r.kt)("td",{parentName:"tr",align:null},"100% - no attestation rewards during that time or highly reduced"),(0,r.kt)("td",{parentName:"tr",align:null},"5-10% during that time."),(0,r.kt)("td",{parentName:"tr",align:null},"TBC - not enough data yet")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Average block processing time of new blocks during process")),(0,r.kt)("td",{parentName:"tr",align:null},"N/A - new blocks are being processed after state but are significantly slower until OldBodies and OldReceipts are downloaded. Afterwards, average about 0.35s"),(0,r.kt)("td",{parentName:"tr",align:null},"0.7s"),(0,r.kt)("td",{parentName:"tr",align:null},"1.0s")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Is node online during process?")),(0,r.kt)("td",{parentName:"tr",align:null},"No - unless State is synced"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes - node follows chain and all modules are still enabled."),(0,r.kt)("td",{parentName:"tr",align:null},"Yes - node follows chain and all modules are still enabled.")))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Command used for testing IOPS of disk:\\\n",(0,r.kt)("inlineCode",{parentName:"p"},"fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=test --bs=4k --iodepth=64 --size=4G --readwrite=randrw"))))}c.isMDXComponent=!0}}]);