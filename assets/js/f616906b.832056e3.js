"use strict";(self.webpackChunknethermind_docs=self.webpackChunknethermind_docs||[]).push([[1897],{9663:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>d,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"developers/plugins/plugins","title":"Plugins","description":"Nethermind plugins are a powerful way of extending its capabilities by adding new features and functionalities. If you need a functionality missing in Nethermind, you can add it yourself as a plugin! Actually, many Nethermind features are implemented as plugins, like L2 network support such as Optimism and Taiko, health checks, and Shutter, to name a few. The sky is the limit. Almost.","source":"@site/versioned_docs/version-1.31.0/developers/plugins/plugins.md","sourceDirName":"developers/plugins","slug":"/developers/plugins/","permalink":"/1.31.0/developers/plugins/","draft":false,"unlisted":false,"editUrl":"https://github.com/NethermindEth/docs/tree/main/versioned_docs/version-1.31.0/developers/plugins/plugins.md","tags":[],"version":"1.31.0","lastUpdatedAt":1760963629000,"sidebarPosition":1,"frontMatter":{"title":"Plugins","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Building from source","permalink":"/1.31.0/developers/building-from-source"},"next":{"title":"JSON-RPC handler","permalink":"/1.31.0/developers/plugins/samples/json-rpc-handler"}}');var s=i(4848),r=i(8453),o=i(9487),l=i(1470),h=i(9365);const d={title:"Plugins",sidebar_position:1},a=void 0,c={},u=[{value:"Creating a basic plugin",id:"creating-a-basic-plugin",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Attaching to process",id:"debug-attach",level:3},{value:"Debugging with Nethermind codebase",id:"debug-codebase",level:3},{value:"Step 1: Clone the Nethermind repo",id:"debug-codebase-step-1",level:4},{value:"Step 2: Configure the startup project",id:"debug-codebase-step-2",level:4},{value:"Step 3: Add the plugin project to the solution",id:"debug-codebase-step-3",level:4},{value:"Step 4: Configure build dependencies",id:"debug-codebase-step-4",level:4},{value:"Launching the debugger",id:"debug-codebase-launch",level:4},{value:"Plugin types",id:"plugin-types",level:2},{value:"<code>IConsensusPlugin</code>",id:"iconsensusplugin",level:4},{value:"<code>IConsensusWrapperPlugin</code>",id:"iconsensuswrapperplugin",level:4},{value:"<code>IInitializationPlugin</code>",id:"iinitializationplugin",level:4},{value:"<code>ISynchronizationPlugin</code>",id:"isynchronizationplugin",level:4},{value:"Samples",id:"samples",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Nethermind plugins are a powerful way of extending its capabilities by adding new features and functionalities. If you need a functionality missing in Nethermind, you can add it yourself as a plugin! Actually, many Nethermind features are implemented as plugins, like L2 network support such as Optimism and Taiko, health checks, and Shutter, to name a few. The sky is the limit. Almost."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Nethermind plugins are .NET assemblies (.dll) that Nethermind's process loads on startup. By default, they are located in the ",(0,s.jsx)(n.code,{children:"plugins"})," directory. To set a different location for plugins, use the ",(0,s.jsx)(n.a,{href:"/1.31.0/fundamentals/configuration#plugins-dir",children:(0,s.jsx)(n.code,{children:"--plugins-dir"})})," command line option. In that case, move the bundled plugins to the new location to ensure the correct functionality of Nethermind."]})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["We have a dedicated ",(0,s.jsx)(n.a,{href:"https://discord.gg/K8MdZT3keK",children:"Discord channel"})," for plugin development. Please get in touch with us if you have any issues or need functionality that is not provided by the current plugin API."]})}),"\n",(0,s.jsx)(n.p,{children:"This guide will walk you through writing a simple plugin to better understand the Nethermind plugin API and its capabilities."}),"\n",(0,s.jsx)(n.h2,{id:"creating-a-basic-plugin",children:"Creating a basic plugin"}),"\n",(0,s.jsx)(n.admonition,{title:"Before you begin",type:"info",children:(0,s.jsxs)(n.p,{children:["Ensure you have installed the required version of the .NET SDK. See ",(0,s.jsx)(n.a,{href:"/1.31.0/developers/building-from-source#prerequisites",children:"Building from source"})," for the details."]})}),"\n",(0,s.jsx)(n.p,{children:"To write a Nethermind plugin, you need the Nethermind API to be available to your code. There are two ways of achieving that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Using the ",(0,s.jsx)(n.a,{href:"https://www.nuget.org/packages/Nethermind.ReferenceAssemblies",children:"Nethermind.ReferenceAssemblies"})," NuGet package. This package is updated with each Nethermind release and is versioned the same. Thus, when choosing this approach, ensure the package version is lower than or equal to your target Nethermind version."]}),"\n",(0,s.jsx)(n.li,{children:"Checking out the Nethermind source code and reference the required projects from the plugin. While this approach seems better for debugging your code, some setups had assembly version mismatch issues after upgrading Nethermind."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"In this guide, we will use the first approach. So, let's pick a working directory for the plugin and create a library project as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dotnet new classlib -n DemoPlugin -o .\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now, we need to add the NuGet package to get access to the Nethermind API:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dotnet add package Nethermind.ReferenceAssemblies\n"})}),"\n",(0,s.jsxs)(n.p,{children:["As the package name implies, it provides ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/standard/assembly/reference-assemblies",children:"reference assemblies"})," that are only enough to compile the project. To see the plugin in action, put the library assembly (.dll) in the Nethermind's\xa0plugins\xa0directory and then run Nethermind. We will get to that soon."]}),"\n",(0,s.jsx)(n.p,{children:'Now, we have everything we need to begin with the actual implementation. For the sake of simplicity, we will create a basic plugin, a classic example, that simply prints the famous "Hello, world!" message.'}),"\n",(0,s.jsxs)(n.p,{children:["All Nethermind plugins must implement the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/INethermindPlugin.cs",children:(0,s.jsx)(n.code,{children:"INethermindPlugin"})})," interface. That's how Nethermind recognizes its plugins. So, let's create a ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," class implementing that interface:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="DemoPlugin.cs" showLineNumbers',children:'using Nethermind.Api;\nusing Nethermind.Api.Extensions;\n\nnamespace DemoPlugin;\n\npublic class DemoPlugin : INethermindPlugin\n{\n    public string Name => "Demo plugin";\n    public string Description => "A sample plugin for demo";\n    public string Author => "Anonymous";\n\n    // The entry point of the plugin\n    public Task Init(INethermindApi nethermindApi)\n    {\n        var logger = nethermindApi.LogManager.GetClassLogger();\n        logger.Warn("Hello, world!");\n\n        return Task.CompletedTask;\n    }\n\n    // Initializes the network stack\n    public Task InitNetworkProtocol() => Task.CompletedTask;\n    // Initializes the JSON-RPC stuff\n    public Task InitRpcModules() => Task.CompletedTask;\n    // Initializes the transaction-related stuff\n    public void InitTxTypesAndRlpDecoders(INethermindApi api) { }\n    // Cleans up resources\n    public ValueTask DisposeAsync() => default;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Let's examine the code above. The properties at lines 8-10 are required and self-explanatory. They are displayed on Nethermind startup for each loaded plugin. Next is the ",(0,s.jsx)(n.code,{children:"Init()"})," method at line 13, which is the main entry point of any plugin where initialization begins. Its only argument of type ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/INethermindApi.cs",children:(0,s.jsx)(n.code,{children:"INethermindApi"})})," \u2192 ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/IApiWithNetwork.cs",children:(0,s.jsx)(n.code,{children:"IApiWithNetwork"})})," \u2192 ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/IApiWithBlockchain.cs",children:(0,s.jsx)(n.code,{children:"IApiWithBlockchain"})})," \u2192 ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/IApiWithStores.cs",children:(0,s.jsx)(n.code,{children:"IApiWithStores"})})," \u2192 ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/IBasicApi.cs",children:(0,s.jsx)(n.code,{children:"IBasicApi"})})," is the main gateway to the Nethermind API, as its name implies. The ",(0,s.jsx)(n.code,{children:"INethermindApi"})," interface provides a rich functionality set essential for plugin development and is widely used in the Nethermind codebase."]}),"\n",(0,s.jsx)(n.p,{children:"In line 15, we get the logger instance we need to print our message. Usually, that instance is stored in a private field to be available to other class members, but in our example, we don't need that. Once we have the instance, we log the message as a warning so you can spot it easily in the logs."}),"\n",(0,s.jsx)(n.p,{children:"The methods in lines 22-28 are irrelevant for this example, so they are left empty. We will get to them in later examples."}),"\n",(0,s.jsx)(n.p,{children:"To see our plugin in action, let's build it first:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dotnet build\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Once built, we need to copy the ",(0,s.jsx)(n.code,{children:"DemoPlugin.dll"})," to Nethermind's ",(0,s.jsx)(n.code,{children:"plugins"})," directory and run Nethermind. The output should be similar to the one below:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"24 Jan 18:01:37 | Nethermind is starting up\n...\n24 Jan 18:01:37 | Loading 14 assemblies from ...\n# highlight-start\n24 Jan 18:01:37 | Loading assembly DemoPlugin\n24 Jan 18:01:37 |   Found plugin type DemoPlugin\n# highlight-end\n24 Jan 18:01:37 | Loading assembly Nethermind.Api\n...\n24 Jan 18:01:39 | Initializing 17 plugins\n...\n24 Jan 18:01:39 |   EthStats by Nethermind\n24 Jan 18:01:39 |   EthStats by Nethermind initialized in 0ms\n# highlight-start\n24 Jan 18:01:39 |   Demo plugin by Anonymous\n24 Jan 18:01:39 | Hello, world!\n24 Jan 18:01:39 |   Demo plugin by Anonymous initialized in 0ms\n# highlight-end\n...\n"})}),"\n",(0,s.jsx)(n.p,{children:"That's it! We created our very first Nethermind plugin."}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"As Nethermind is highly configurable, so may its plugins. The same flexible configuration features that Nethermind uses internally are also available to its plugins. That means a plugin can be configured with command line options, environment variables, and configuration files by simply implementing a single interface."}),"\n",(0,s.jsx)(n.p,{children:"Nethermind loads and runs all the plugins it finds on startup. This behavior may be undesirable for resource-hungry plugins or incompatible with those requiring a specific network (chain) to run on. Thus, a typical scenario for almost any plugin is to be turned on or off by a configuration setting. Let's implement that feature for our Demo plugin."}),"\n",(0,s.jsxs)(n.p,{children:["All Nethermind configurations must implement the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Config/IConfig.cs",children:(0,s.jsx)(n.code,{children:"IConfig"})})," interface. It's a 2 step process."]}),"\n",(0,s.jsxs)(n.p,{children:["First, we derive a new interface from the ",(0,s.jsx)(n.code,{children:"IConfig"})," and add all the required configuration options as properties. In our case, it's a single boolean property ",(0,s.jsx)(n.code,{children:"Enabled"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="IDemoConfig.cs" showLineNumbers',children:'using Nethermind.Config;\n\nnamespace DemoPlugin;\n\npublic interface IDemoConfig : IConfig\n{\n    // The attribute below is optional and serves as documentation\n    [ConfigItem(Description = "Whether to enable the Demo plugin.", DefaultValue = "false")]\n    bool Enabled { get; set; }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Second, we implement the interface above as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="DemoConfig.cs" showLineNumbers',children:"namespace DemoPlugin;\n\npublic class DemoConfig : IDemoConfig\n{\n    public bool Enabled { get; set; }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["That's it for the configuration. Now, let's check for the value of ",(0,s.jsx)(n.code,{children:"Enabled"})," in the ",(0,s.jsx)(n.code,{children:"Init()"})," method and only log the message if it's ",(0,s.jsx)(n.code,{children:"true"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public Task Init(INethermindApi nethermindApi)\n{\n    var logger = nethermindApi.LogManager.GetClassLogger();\n    // highlight-start\n    var config = nethermindApi.Config<IDemoConfig>();\n    // highlight-end\n\n    if (config.Enabled)\n        logger.Warn("Hello, world!");\n\n    return Task.CompletedTask;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"The highlighted line shows how to get the configuration instance. Note that we get it by its interface type, not the implementing class. That's an important detail."}),"\n",(0,s.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,s.jsxs)(n.p,{children:["The configuration interface name must be in the ",(0,s.jsx)(n.code,{children:"I{PluginName}Config"})," format. In our case, it's ",(0,s.jsx)(n.code,{children:"IDemoConfig"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:["The naming convention is crucial for mapping the configuration options. For instance, ",(0,s.jsx)(n.code,{children:"IDemoConfig.Enabled"})," turns into the following configuration options:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--demo-enabled"})," or ",(0,s.jsx)(n.code,{children:"--Demo.Enabled"})," as a command line option"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NETHERMIND_DEMOCONFIG_ENABLED"})," as an environment variable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'{ "Demo": { "Enabled": true|false } }'})," as a JSON in a configuration file"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Since now we know what our configuration options are, let's build the project, copy the library to Nethermind's\xa0plugins\xa0directory, and run Nethermind as we did previously:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"24 Jan 18:01:37 | Nethermind is starting up\n...\n24 Jan 18:01:37 | Loading 14 assemblies from ...\n# highlight-start\n24 Jan 18:01:37 | Loading assembly DemoPlugin\n24 Jan 18:01:37 |   Found plugin type DemoPlugin\n# highlight-end\n24 Jan 18:01:37 | Loading assembly Nethermind.Api\n...\n24 Jan 18:01:39 | Initializing 17 plugins\n...\n24 Jan 18:01:39 |   EthStats by Nethermind\n24 Jan 18:01:39 |   EthStats by Nethermind initialized in 0ms\n# highlight-start\n24 Jan 18:01:39 |   Demo plugin by Anonymous\n24 Jan 18:01:39 |   Demo plugin by Anonymous initialized in 0ms\n# highlight-end\n...\n"})}),"\n",(0,s.jsxs)(n.p,{children:['There\'s a slight difference compared to the previous run -- the "Hello, world!" message is gone. The reason is that we put it under an ',(0,s.jsx)(n.code,{children:"if"})," condition which has not been entered because of the ",(0,s.jsx)(n.code,{children:"IDemoConfig.Enabled"})," is ",(0,s.jsx)(n.code,{children:"false"})," by default. Let's set it to ",(0,s.jsx)(n.code,{children:"true"})," using the command line option as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nethermind --demo-enabled true\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now we see that our message is back, and the configuration option works as intended! That is how to turn plugins on or off in Nethermind and provide other configuration options."}),"\n",(0,s.jsxs)(n.p,{children:["Last, let's test our plugin configuration documentation defined at line 8 in ",(0,s.jsx)(n.code,{children:"IDemoConfig.cs"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nethermind -h\n"})}),"\n",(0,s.jsx)(n.p,{children:"The output should be similar to the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Description:\n\nUsage:\n  nethermind [options]\n\nOptions:\n  -?, -h, --help                                              Show help and usage information\n  --version                                                   Show version information\n...\n# highlight-start\n  --demo-enabled, --Demo.Enabled <value>                      Whether to enable the Demo plugin.\n# highlight-end\n  --era-exportdirectory, --Era.ExportDirectory <value>        Directory of archive export.\n  --era-from, --Era.From <value>                              Block number to import/export from.\n...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,s.jsx)(n.p,{children:"As your code grows more complex and sophisticated, you may want to debug it at some point. These are the two ways to do that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#debug-attach",children:"Attaching the debugger to the Nethermind process"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#debug-codebase",children:"Debugging the plugin together with the Nethermind codebase"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"debug-attach",children:"Attaching to process"}),"\n",(0,s.jsx)(n.p,{children:"This approach is preferable if you focus on your plugin only and don't need to debug the Nethermind codebase."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["This guide assumes you already have installed Nethermind. If you haven't, ",(0,s.jsx)(n.a,{href:"/1.31.0/get-started/installing-nethermind",children:"install"})," it before moving on."]})}),"\n",(0,s.jsxs)(n.p,{children:["We recommend using Visual Studio or JetBrains Rider as a debugger on Windows. On Linux and macOS, we recommend JetBrains Rider. While Visual Studio Code can also attach to and debug processes, it ",(0,s.jsx)(n.a,{href:"https://github.com/dotnet/vscode-csharp/wiki/Troubleshoot-loading-the-.NET-Debug-Services#error-cause-1-net-debugging-services-library-file-is-missing",children:"does not support"}),' debugging the "SingleFile" .NET distributions that Nethermind distributives are.']}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"You may want to check out the following before moving on:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/visualstudio/debugger/attach-to-running-processes-with-the-visual-studio-debugger",children:"Attach to process with Visual Studio"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.jetbrains.com/help/rider/attach-to-process.html",children:"Attach to process with JetBrains Rider"})}),"\n"]})]}),"\n",(0,s.jsx)(n.p,{children:"Before attaching the debugger to the Nethermind process, we need to ensure Nethermind will pick up our plugin. There are two ways:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Run Nethermind with the ",(0,s.jsx)(n.a,{href:"/1.31.0/fundamentals/configuration#plugins-dir",children:(0,s.jsx)(n.code,{children:"--plugins-dir"})})," command line option set to the output directory of the plugin project. We recommend copying the other bundled plugins from the original ",(0,s.jsx)(n.code,{children:"plugins"})," directory to the new destination as you may be required depending on your use case."]}),"\n",(0,s.jsxs)(n.li,{children:["Set the plugin project output to the Nethermind's ",(0,s.jsx)(n.code,{children:"plugins"})," directory."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Either of the above approaches will ensure Nethermind loads our plugin with the latest changes automatically. The following video demonstrates what the debugging process looks like:"}),"\n",(0,s.jsx)("p",{align:"center",children:(0,s.jsx)(o.A,{controls:!0,url:"https://github.com/user-attachments/assets/267904d4-444e-4eac-91c2-bd76c796c6f3"})}),"\n",(0,s.jsx)(n.h3,{id:"debug-codebase",children:"Debugging with Nethermind codebase"}),"\n",(0,s.jsxs)(n.p,{children:["Another way to debug plugins is to debug them along with the Nethermind codebase. That requires obtaining the Nethermind source code and debugging it with the IDE of your choice. Visual Studio and JetBrains Rider are the most popular choices. Let's try that with our ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," example."]}),"\n",(0,s.jsx)(n.h4,{id:"debug-codebase-step-1",children:"Step 1: Clone the Nethermind repo"}),"\n",(0,s.jsxs)(n.p,{children:["We highly recommend cloning a stable version of the codebase to avoid any unwanted behavior on debugging. Usually, it's the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/releases/latest",children:"latest"})," released version of Nethermind. For example, the command below clones Nethermind v1.30.0:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'git clone -b "1.30.0" --depth 1 https://github.com/nethermindeth/nethermind.git\n'})}),"\n",(0,s.jsx)(n.h4,{id:"debug-codebase-step-2",children:"Step 2: Configure the startup project"}),"\n",(0,s.jsxs)(n.p,{children:["In the repo's root directory, open the ",(0,s.jsx)(n.code,{children:"src/Nethermind/Nethermind.sln"})," and set the ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," as a startup project. That is the Nethermind's executable that handles everything, including plugins."]}),"\n",(0,s.jsx)(n.h4,{id:"debug-codebase-step-3",children:"Step 3: Add the plugin project to the solution"}),"\n",(0,s.jsxs)(n.p,{children:["Add the ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," project to the solution to have everything in one place. Then, let's set the ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," project output to Nethermind's ",(0,s.jsx)(n.code,{children:"plugins"})," directory so the latest changes are always available for ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," to pick up. Add the following to the ",(0,s.jsx)(n.code,{children:"DemoPlugin.csproj"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<PropertyGroup>\n  <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>\n  <OutputPath>$(SolutionDir)/artifacts/bin/Nethermind.Runner/debug/plugins</OutputPath>\n</PropertyGroup>\n"})}),"\n",(0,s.jsx)(n.h4,{id:"debug-codebase-step-4",children:"Step 4: Configure build dependencies"}),"\n",(0,s.jsxs)(n.p,{children:["Last, let's configure build dependencies so that launching ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," automatically builds our ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," with its latest changes, so you don't need to build the plugin separately each time before launching the debugger. With this said, we need to make the ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," project depend on the ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," project. See how to configure project dependencies below:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/visualstudio/ide/how-to-create-and-remove-project-dependencies#to-assign-dependencies-to-projects",children:"Project dependencies in Visual Studio"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.jetbrains.com/help/rider/Architecture__Project_Dependencies_Exploration.html",children:"Project dependencies in JetBrains Rider"})}),"\n"]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"IDE-agnostic workaround"}),(0,s.jsxs)(n.p,{children:["If your IDE doesn't provide project dependency configuration, you can achieve that functionality by referencing the ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," project from the ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," project. Run the following from ",(0,s.jsx)(n.code,{children:"src/Nethermind"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dotnet add ./Nethermind.Runner reference path/to/DemoPlugin.csproj\n"})}),(0,s.jsxs)(n.p,{children:["Then, in the ",(0,s.jsx)(n.code,{children:"Nethermind.Runner.csproj"}),", find the reference to ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," and disable the reference output as follows:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",metastring:'title="Nethermind.Runner.csproj"',children:'...\n<ProjectReference Include="path/to/DemoPlugin.csproj">\n\x3c!--highlight-start--\x3e\n  <ReferenceOutputAssembly>false</ReferenceOutputAssembly>\n\x3c!--highlight-end--\x3e\n</ProjectReference>\n...\n'})}),(0,s.jsxs)(n.p,{children:["Thus, the ",(0,s.jsx)(n.code,{children:"DemoPlugin"})," won't be included in the output of ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"}),". This is important to avoid dependency conflicts."]})]}),"\n",(0,s.jsx)(n.h4,{id:"debug-codebase-launch",children:"Launching the debugger"}),"\n",(0,s.jsxs)(n.p,{children:["Now, we're ready to launch the debugger and check the Nethermind logs for our plugin. You may notice that the \"Hello, world!\" message is missing, although Nethermind logs show the plugin is loaded. That's because we made it configurable with the ",(0,s.jsx)(n.code,{children:"Demo.Enabled"})," option, which is ",(0,s.jsx)(n.code,{children:"false"})," by default. Let's set it to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The launch configurations of ",(0,s.jsx)(n.code,{children:"Nethermind.Runner"})," are defined in ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Runner/Properties/launchSettings.json",children:(0,s.jsx)(n.code,{children:"launchSettings.json"})}),". For instance, if we launch it with Holesky, we set our ",(0,s.jsx)(n.code,{children:"Demo.Enabled"})," configuration option as follows:"]}),"\n",(0,s.jsxs)(l.A,{groupId:"usage",children:[(0,s.jsx)(h.A,{value:"cli",label:"CLI",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="launchSettings.json"',children:'...\n"Holesky": {\n  "commandName": "Project",\n// highlight-start\n  "commandLineArgs": "-c holesky --data-dir .data --demo-enabled true",\n// highlight-end\n  "environmentVariables": {\n    "ASPNETCORE_ENVIRONMENT": "Development"\n  }\n},\n...\n'})})}),(0,s.jsx)(h.A,{value:"env",label:"Environment variable",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="launchSettings.json"',children:'...\n"Holesky": {\n  "commandName": "Project",\n  "commandLineArgs": "-c holesky --data-dir .data",\n  "environmentVariables": {\n    "ASPNETCORE_ENVIRONMENT": "Development",\n// highlight-start\n    "NETHERMIND_DEMOCONFIG_ENABLED": "true"\n// highlight-end\n  }\n},\n...\n'})})})]}),"\n",(0,s.jsx)(n.p,{children:'Now, if we launch the debugger with Holesky, we will see our "Hello, world!" message again!'}),"\n",(0,s.jsx)(n.h2,{id:"plugin-types",children:"Plugin types"}),"\n",(0,s.jsxs)(n.p,{children:["Nethermind defines the following plugin types derived from ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/INethermindPlugin.cs",children:(0,s.jsx)(n.code,{children:"INethermindPlugin"})})," intended for specific functionality:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.h4,{id:"iconsensusplugin",children:(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/IConsensusPlugin.cs",children:(0,s.jsx)(n.code,{children:"IConsensusPlugin"})})}),"\n",(0,s.jsxs)(n.p,{children:["Plugins of this type provide support for consensus algorithms. For example, see the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Optimism/OptimismPlugin.cs",children:(0,s.jsx)(n.code,{children:"OptimismPlugin"})})," or ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Consensus.Ethash/EthashPlugin.cs",children:(0,s.jsx)(n.code,{children:"EthashPlugin"})}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.h4,{id:"iconsensuswrapperplugin",children:(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/IConsensusWrapperPlugin.cs",children:(0,s.jsx)(n.code,{children:"IConsensusWrapperPlugin"})})}),"\n",(0,s.jsxs)(n.p,{children:["Plugins of this type extend or change the handling of the Ethereum PoS consensus algorithm. For example, see the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Merge.Plugin/MergePlugin.cs",children:(0,s.jsx)(n.code,{children:"MergePlugin"})})," or ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Shutter/ShutterPlugin.cs",children:(0,s.jsx)(n.code,{children:"ShutterPlugin"})}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.h4,{id:"iinitializationplugin",children:(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/IInitializationPlugin.cs",children:(0,s.jsx)(n.code,{children:"IInitializationPlugin"})})}),"\n",(0,s.jsxs)(n.p,{children:["Plugins of this type define ",(0,s.jsx)(n.em,{children:"steps"})," required to complete during Nethermind initialization. For example, see the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Init.Snapshot/SnapshotPlugin.cs",children:(0,s.jsx)(n.code,{children:"SnapshotPlugin"})}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.h4,{id:"isynchronizationplugin",children:(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Api/Extensions/ISynchronizationPlugin.cs",children:(0,s.jsx)(n.code,{children:"ISynchronizationPlugin"})})}),"\n",(0,s.jsxs)(n.p,{children:["Plugins of this type implement a custom sync logic. For example, see the ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Optimism/OptimismPlugin.cs",children:(0,s.jsx)(n.code,{children:"OptimismPlugin"})})," or ",(0,s.jsx)(n.a,{href:"https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Taiko/TaikoPlugin.cs",children:(0,s.jsx)(n.code,{children:"TaikoPlugin"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"samples",children:"Samples"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/1.31.0/developers/plugins/samples/json-rpc-handler",children:"JSON-RPC handler"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.em,{children:"More to be added later"})}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);