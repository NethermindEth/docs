<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.26.0 docs-doc-page docs-doc-id-fundamentals/pruning" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Pruning | Nethermind documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/NethermindEth/docs/assets/35319980/163ba000-69b1-45c6-86eb-e8c53109839f"><meta data-rh="true" name="twitter:image" content="https://github.com/NethermindEth/docs/assets/35319980/163ba000-69b1-45c6-86eb-e8c53109839f"><meta data-rh="true" property="og:url" content="https://docs.nethermind.io/1.26.0/fundamentals/pruning"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.26.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.26.0"><meta data-rh="true" name="docsearch:version" content="1.26.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.26.0"><meta data-rh="true" property="og:title" content="Pruning | Nethermind documentation"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.nethermind.io/1.26.0/fundamentals/pruning"><link data-rh="true" rel="alternate" href="https://docs.nethermind.io/1.26.0/fundamentals/pruning" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.nethermind.io/1.26.0/fundamentals/pruning" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4I20VAM8JS-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Nethermind documentation" href="/opensearch.xml">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&amp;family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,300;1,9..40,400;1,9..40,500;1,9..40,600;1,9..40,700&amp;family=Exo:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.0bf3375c.css">
<script src="/assets/js/runtime~main.9a80f58d.js" defer="defer"></script>
<script src="/assets/js/main.b35ae36f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo_dark.svg"><link rel="preload" as="image" href="/img/logo_light.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo_dark.svg" alt="Nethermind" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_light.svg" alt="Nethermind" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/1.26.0/fundamentals/pruning">1.26.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/fundamentals/pruning">Next</a></li><li><a class="dropdown__link" href="/fundamentals/pruning">1.30.0</a></li><li><a class="dropdown__link" href="/1.29.0/fundamentals/pruning">1.29.0</a></li><li><a class="dropdown__link" href="/1.28.0/fundamentals/pruning">1.28.0</a></li><li><a class="dropdown__link" href="/1.27.0/fundamentals/pruning">1.27.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/1.26.0/fundamentals/pruning">1.26.0</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/NethermindEth/nethermind" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social-link header-github-icon" aria-label="GitHub"></a><a href="https://discord.com/invite/PaCMRFdvWT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social-link header-discord-icon" aria-label="Discord"></a><a href="https://x.com/NethermindEth" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-social-link header-x-icon" aria-label="X"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/1.26.0/">Get started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/1.26.0/fundamentals/configuration">Fundamentals</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/sync">Sync</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/logs">Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/1.26.0/fundamentals/pruning">Pruning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/performance-tuning">Performance tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.26.0/fundamentals/private-networks">Private networks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/1.26.0/interacting/json-rpc-server">Interacting with Nethermind</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/1.26.0/monitoring/metrics/">Monitoring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/1.26.0/validators/">Validators</a><button aria-label="Expand sidebar category &#x27;Validators&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/1.26.0/developers/building-from-source">Developers</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.26.0/faq">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.26.0/troubleshooting">Troubleshooting</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Nethermind documentation<!-- --> <b>1.26.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/fundamentals/pruning">latest version</a></b> (<!-- -->1.30.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Fundamentals</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Pruning</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.26.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pruning</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>Pruning pertains to eliminating or cleaning obsolete historical data to optimize disk space. Clients are responsible for maintaining the world state, which comprises a database that portrays the current Ethereum network status. The world state encompasses accounts, contracts, and other information.</p>
<p>Pruning aims to reduce disk requirements by storing only the current world state and removing historical data. This differs from archive nodes that retain complete transaction and state history. Pruning is helpful for users who don&#x27;t require historical data and prefer to interact solely with the current state of the network. However, pruning may limit the client&#x27;s ability to fulfill requests that depend on historical information. Nethermind provides two kinds of pruning – <em>full pruning</em> and <em>in-memory pruning</em>; both are enabled by default, also called <em>hybrid pruning</em>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How it works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h2>
<p>During synchronization using the snap sync method, Nethermind produces a local copy of the Ethereum network state, which typically amounts to approximately 160 GB (state database). The entire database may rise to 600–650GB. Although this size increases by around 30 GB each week, specific historical data is retained that is not necessary for node operation or to maintain the current Ethereum state.</p>
<p>When full pruning is activated and initiated, a thorough examination of the entire state tree is conducted to determine which data is no longer required and can be treated as historical. It then determines which information corresponds to the current state and duplicates it alongside the existing version. During verification of each node in the state, the new pruned state replaces the previous one. Once the verifier confirms everything is functioning correctly, the old state database is eliminated, resulting in significant savings in disk space. As a result, the size of the database will be close to its initial size again.</p>
<p>In-memory pruning is a continuous process that occurs under regular operation. Instead of saving a new state on each block, Nethermind will keep it in memory until a certain threshold is reached. At that point, Nethermind will only store data required by the newer state and discard unnecessary ones. This significantly reduces the total amount of data written while improving block processing performance. In-memory pruning is independent of full pruning.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparation-for-full-pruning">Preparation for full pruning<a href="#preparation-for-full-pruning" class="hash-link" aria-label="Direct link to Preparation for full pruning" title="Direct link to Preparation for full pruning">​</a></h2>
<p>Because full pruning is executed while the node is connected to the network, it can affect the node&#x27;s performance.
The process can consume significant memory, CPU, and disk resources, impacting block processing time.
This, in turn, can lead to reduced rewards for validator setups, particularly for proof-of-stake chains.</p>
<p>Currently, full pruning takes between 20 to 30 hours to complete, although the duration may vary based on the hardware configuration. At least 200 GB of storage is required to ensure pruning runs smoothly. Nevertheless, it&#x27;s recommended to have 300 GB or more.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Important</div><div class="admonitionContent_BuS1"><p>Do not turn on full pruning on an archive node, as these are two opposing features. Archive nodes are designed to store
complete historical data, whereas full pruning eliminates it. Use the option <code>--Pruning.Mode None</code> to ensure that pruning is turned off completely.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-full-pruning">Configuring full pruning<a href="#configuring-full-pruning" class="hash-link" aria-label="Direct link to Configuring full pruning" title="Direct link to Configuring full pruning">​</a></h2>
<p>As a very first point, check out the <a href="/1.26.0/fundamentals/configuration#pruning">pruning configuration options</a>.<br>
<!-- -->To activate full pruning, use either the <code>--Pruning.Mode Hybrid</code> or <code>--Pruning.Mode Full</code> command line options.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Setting <code>--Pruning.Mode Hybrid</code> enables both <code>InMemory</code> and <code>Full</code> modes. The <code>InMemory</code> mode helps the node storage grow slower than the <code>Full</code> mode. Because of this, full pruning is executed less frequently, promoting
healthier disk operation. Since full pruning is hardware-intensive, this configuration also benefits attestation results.</p></div></div>
<p>The next step is to determine the trigger conditions for full pruning. Currently, there are 3 options available:</p>
<ul>
<li><a href="#manual">Manual</a></li>
<li><a href="#state-db-threshold">State database size threshold</a></li>
<li><a href="#storage-left-threshold">Remaining storage space threshold</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual">Manual<a href="#manual" class="hash-link" aria-label="Direct link to Manual" title="Direct link to Manual">​</a></h3>
<p>Manual mode triggers full pruning only upon request, providing complete control. To configure this mode, use the following options: <code>--Pruning.Mode Hybrid --Pruning.FullPruningTrigger Manual</code>.</p>
<p>Pruning can also be triggered using the <a href="/1.26.0/interacting/json-rpc-ns/admin#admin_prune"><code>admin_prune</code></a> JSON-RPC method. Here&#x27;s how to configure it:</p>
<ul>
<li>Add the <code>admin</code> namespace to <code>--JsonRpc.EnabledModules</code>. For instance,<br>
<code>--JsonRpc.EnabledModules [eth,net,...,admin]</code></li>
<li>Create a separate port for <code>admin</code> namespace only:<br>
<code>--JsonRpc.AdditionalRpcUrls http://localhost:8555|http|admin</code></li>
</ul>
<p>Restart the client, and if everything is configured correctly, you should be able to call the <code>admin_prune</code> method, and full pruning should start.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>One potential disadvantage of the manual mode is that if full pruning is not triggered on time, it cannot be performed later because of insufficient disk space. In such cases, the only option to free up the disk space is to resync the node from scratch.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="state-db-threshold">State database size threshold<a href="#state-db-threshold" class="hash-link" aria-label="Direct link to State database size threshold" title="Direct link to State database size threshold">​</a></h3>
<p>This mode triggers full pruning automatically when the state database reaches the specified size.
To enable this mode, use the following options: <code>--Pruning.Mode Hybrid --Pruning.FullPruningTrigger StateDbSize --Pruning.FullPruningThresholdMb 256000</code>, where the value of <code>Pruning.FullPruningThresholdMb</code> should be set based on your requirements.</p>
<p>The above configuration triggers full pruning automatically whenever the state database size exceeds 256,000
MB (250 GB). Assuming the state database has initially around 160 GB, pruning will be triggered when the database size grows by more than 90 GB.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>To avoid unexpected behavior and ensure that full pruning can be completed in full, it&#x27;s recommended to set the threshold value to trigger pruning before the free disk space drops below 250 GB as a minimum. This ensures that sufficient free disk space is available for the pruning process.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-left-threshold">Remaining storage space threshold<a href="#storage-left-threshold" class="hash-link" aria-label="Direct link to Remaining storage space threshold" title="Direct link to Remaining storage space threshold">​</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This is the recommended approach as it ensures that pruning is executed on time.</p></div></div>
<p>This mode triggers full pruning when the storage space reaches the specified minimum. To enable this mode, use the following options: <code>--Pruning.Mode Hybrid --Pruning.FullPruningTrigger VolumeFreeSpace --Pruning.FullPruningThresholdMb 256000</code>, where the value of <code>Pruning.FullPruningThresholdMb</code> should be set based on your requirements. However, it should not be set below the default value of <code>256000</code>.</p>
<p>The above configuration triggers full pruning whenever free disk space drops to 256,000 MB (250 GB) or below. This ensures that pruning is invoked as infrequently as possible while also ensuring that sufficient free storage is always available to trigger it.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>It&#x27;s recommended not to set the value below 250 GB for stability reasons. In reality, full pruning should require approximately the same amount of storage as a fresh state database (around 160 GB). Still, it also needs a threshold for processing and other operations since it creates a copy of the existing state database. Therefore, it&#x27;s essential to maintain a minimum amount of storage to ensure a robust pruning performance.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-progress">Monitoring progress<a href="#monitoring-progress" class="hash-link" aria-label="Direct link to Monitoring progress" title="Direct link to Monitoring progress">​</a></h2>
<p>When full pruning is triggered correctly, the corresponding messages appear in the Nethermind logs.</p>
<p>The very first ones should be:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Full Pruning Ready to start: pruning garbage before state &lt;block number&gt; with root &lt;hash&gt;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARN: Full Pruning Started on root hash &lt;hash&gt;: do not close the node until finished or progress will be lost.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>From that moment, ensure that no restarts will be performed on Nethermind to ensure that full pruning runs correctly.
After a few minutes first logs with progress would start to appear. For instance:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Full Pruning In Progress: 00:00:57.0603307 1.00 mln nodes mirrored.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Full Pruning In Progress: 00:01:40.3677103 2.00 mln nodes mirrored.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Full Pruning In Progress: 00:02:25.6437030 3.00 mln nodes mirrored.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pruning may take even <em>more than 30 hours</em>, depending on hardware configuration.</p>
<p>When pruning is completed, there is a log message similar the following:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Full Pruning Finished: 15:25:59.1620756 1,560.29 mln nodes mirrored.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you may notice, it took around 15 hours in this example.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Since the amount of mirrored nodes is not a static value, providing a simple progress indicator in percentage is impossible. Therefore, the approximate value given should be used to determine when full pruning is expected to be completed.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-settings">Additional settings<a href="#additional-settings" class="hash-link" aria-label="Direct link to Additional settings" title="Direct link to Additional settings">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-budget">Memory budget<a href="#memory-budget" class="hash-link" aria-label="Direct link to Memory budget" title="Direct link to Memory budget">​</a></h3>
<p>The <code>Pruning.FullPruningMemoryBudgetMb</code> configuration option controls the memory budget allocated for the trie visit during
the full pruning process. During pruning, pending nodes are queued to a pool of nodes whose size is determined by this value. This allows multiple nodes to share a single I/O. By increasing this value, the required read IOP per second can be significantly reduced, resulting in a faster full pruning operation. However, this improvement comes at the expense of increased memory usage.</p>
<p>Assuming your system has 64GB of RAM, with Nethermind, the consensus client, and system expenses consuming 20GB,
you need to determine the maximum value for <code>Pruning.FullPruningMemoryBudgetMb</code> while ensuring the system remains stable and respects the given limit. In this case, you have 44 GB (64 GB - 20 GB) of available memory for increasing the <code>Pruning.FullPruningMemoryBudgetMb</code> value. To calculate the maximum value in MB, multiply the available memory by 1024: <code>44 GB * 1024 = 45,056 MB</code></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Because of the workload on Ethereum Mainnet, setting the value of <code>Pruning.FullPruningMemoryBudgetMb</code> higher than 16 GB may not provide any additional performance benefits.</p></div></div>
<p>Please note that this example assumes the remaining 44 GB of memory is sufficient for the full pruning memory budget.
Depending on the specific use case and system requirements, it may be necessary to adjust the value further to optimize performance and resource usage.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pruning-completion-behavior">Pruning completion behavior<a href="#pruning-completion-behavior" class="hash-link" aria-label="Direct link to Pruning completion behavior" title="Direct link to Pruning completion behavior">​</a></h3>
<p>The <code>Pruning.FullPruningCompletionBehavior</code> configuration option determines Nethermind&#x27;s behavior after full pruning is completed. By default, Nethermind will continue to progress as usual. However, if a user wishes to shut down the node after pruning, there are three options available:</p>
<ul>
<li><code>None</code>: No action taken</li>
<li><code>ShutdownOnSuccess</code>: Nethermind shuts down if pruning succeeds</li>
<li><code>AlwaysShutdown</code>: Nethermind shuts down once pruning completes, regardless of whether it succeeds or fails</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="number-of-pruning-concurrent-tasks">Number of pruning concurrent tasks<a href="#number-of-pruning-concurrent-tasks" class="hash-link" aria-label="Direct link to Number of pruning concurrent tasks" title="Direct link to Number of pruning concurrent tasks">​</a></h3>
<p>The <code>Pruning.FullPruningMaxDegreeOfParallelism</code> configuration option determines the number of parallel tasks/threads that can be used by pruning:</p>
<ul>
<li><code>-1</code>: uses the number of logical processors</li>
<li><code>0</code>: uses 25% of logical processors</li>
<li><code>1</code>: runs on a single thread</li>
</ul>
<p>The recommended value depends on the type of node being used. If the node needs to be responsive (e.g., RPC or validator), using a value below the number of logical processors is recommended. The default value is recommended if the node doesn&#x27;t have many other responsibilities but needs to follow the chain without delays and produce live logs reliably. If the node doesn&#x27;t need to be responsive, has very fast I/O (such as NVMe), and the shortest pruning time
is desired, this can be set to 2–3 times the number of logical processors.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="in-memory-cache-size">In-memory cache size<a href="#in-memory-cache-size" class="hash-link" aria-label="Direct link to In-memory cache size" title="Direct link to In-memory cache size">​</a></h3>
<p>The <code>Pruning.CacheMb</code> configuration option determines the size, in MB, of the memory pool of nodes used for in-memory pruning. The default value is 1024. Increasing this value can help reduce the rate at which the state database grows.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="side-notes">Side notes<a href="#side-notes" class="hash-link" aria-label="Direct link to Side notes" title="Direct link to Side notes">​</a></h2>
<p>For pruning, keep in mind the following:</p>
<ul>
<li>Full pruning is a cumbersome task, but it&#x27;s performed in the background, so the node continues progressing and following the chain.</li>
<li>The process&#x27; heaviness may affect the effectiveness of the validator rewards. Still, since it&#x27;s executed only once every few months, it shouldn&#x27;t have a significant impact on overall results (we&#x27;ve xperienced approximately 5–10% loss of rewards during full pruning).</li>
<li>Ensure that your storage has at least 250 GB of free space after syncing the node. Otherwise, full pruning will never complete successfully.</li>
<li>Several things can be done to reduce the size of the database after syncing: setting <code>Sync.AncientBodiesBarrier</code> and <code>Sync.AncientReceiptsBarrier</code> to a proper value higher than 0, using a consensus client that requires less storage, and setting logs to the lowest level to avoid log spamming.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/NethermindEth/docs/tree/main/versioned_docs/version-1.26.0/fundamentals/pruning.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-01-30T19:24:44.000Z" itemprop="dateModified">Jan 30, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/1.26.0/fundamentals/database"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/1.26.0/fundamentals/performance-tuning"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Performance tuning</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a></li><li><a href="#preparation-for-full-pruning" class="table-of-contents__link toc-highlight">Preparation for full pruning</a></li><li><a href="#configuring-full-pruning" class="table-of-contents__link toc-highlight">Configuring full pruning</a><ul><li><a href="#manual" class="table-of-contents__link toc-highlight">Manual</a></li><li><a href="#state-db-threshold" class="table-of-contents__link toc-highlight">State database size threshold</a></li><li><a href="#storage-left-threshold" class="table-of-contents__link toc-highlight">Remaining storage space threshold</a></li></ul></li><li><a href="#monitoring-progress" class="table-of-contents__link toc-highlight">Monitoring progress</a></li><li><a href="#additional-settings" class="table-of-contents__link toc-highlight">Additional settings</a><ul><li><a href="#memory-budget" class="table-of-contents__link toc-highlight">Memory budget</a></li><li><a href="#pruning-completion-behavior" class="table-of-contents__link toc-highlight">Pruning completion behavior</a></li><li><a href="#number-of-pruning-concurrent-tasks" class="table-of-contents__link toc-highlight">Number of pruning concurrent tasks</a></li><li><a href="#in-memory-cache-size" class="table-of-contents__link toc-highlight">In-memory cache size</a></li></ul></li><li><a href="#side-notes" class="table-of-contents__link toc-highlight">Side notes</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>