<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-fundamentals/how-to-reduce-database-size/full-pruning">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Full Pruning | Nethermind documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nethermind.github.io/docs/fundamentals/how-to-reduce-database-size/full-pruning"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Full Pruning | Nethermind documentation"><meta data-rh="true" name="description" content="Explanation of Full Pruning, including its requirements and steps to execute it."><meta data-rh="true" property="og:description" content="Explanation of Full Pruning, including its requirements and steps to execute it."><link data-rh="true" rel="icon" href="/docs/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://nethermind.github.io/docs/fundamentals/how-to-reduce-database-size/full-pruning"><link data-rh="true" rel="alternate" href="https://nethermind.github.io/docs/fundamentals/how-to-reduce-database-size/full-pruning" hreflang="en"><link data-rh="true" rel="alternate" href="https://nethermind.github.io/docs/fundamentals/how-to-reduce-database-size/full-pruning" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Nethermind documentation" href="/docs/opensearch.xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;family=Red+Hat+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;family=Red+Hat+Text:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap&quot; rel=&quot;stylesheet"><link rel="stylesheet" href="/docs/assets/css/styles.d9f99d2b.css">
<link rel="preload" href="/docs/assets/js/runtime~main.8015b15e.js" as="script">
<link rel="preload" href="/docs/assets/js/main.2bc10912.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo_dark.svg" alt="Nethermind" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logo_light.svg" alt="Nethermind" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docs/">v1.20.1</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/NethermindEth/nethermind" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><a href="https://discord.com/invite/PaCMRFdvWT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Discord"></a><a href="https://twitter.com/NethermindEth" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-x-link" aria-label="X"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/get-started">Get started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Get started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/fundamentals">Fundamentals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/running-nethermind">Running Nethermind</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/private-networks">Private networks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Private networks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/sync-modes">Sync modes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/security">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/logs">Logs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Logs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/database">Database</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/how-to-reduce-the-size-of-the-database">How to reduce the size of the database</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to reduce the size of the database&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/how-to-reduce-database-size">How to reduce database size</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/fundamentals/how-to-reduce-database-size/full-pruning">Full Pruning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/how-to-reduce-database-size/resync-database-from-scratch">Resync database from scratch</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/interacting-with-nethermind">Interacting With Nethermind</a><button aria-label="Toggle the collapsible sidebar category &#x27;Interacting With Nethermind&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/monitoring">Monitoring</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/developers">Developers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/nethermind-utilities">Nethermind Utilities</a><button aria-label="Toggle the collapsible sidebar category &#x27;Nethermind Utilities&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/resources">Resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/fundamentals"><span itemprop="name">Fundamentals</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/how-to-reduce-the-size-of-the-database"><span itemprop="name">How to reduce the size of the database</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Full Pruning</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Full Pruning</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Full Pruning pertains to the elimination or cleanup of obsolete historical data to optimize disk space. Clients are
responsible for maintaining the world state, which comprises a database that portrays the current Ethereum network
status. The world state encompasses accounts, contracts, and other information.</p><p>The goal of Full Pruning is to reduce disk requirements by storing only the current world state and removing historical
data. This differs from archive nodes that retain complete transaction and state history. Full Pruning is useful for
users who don&#x27;t require historical data and prefer to interact solely with the current state of the network. However,
Full Pruning may limit the client&#x27;s ability to fulfill requests that depend on historical information.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How it works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h2><p>During synchronization using the Snap Sync method, the Nethermind client produces a local copy of the Ethereum Network
state, which typically amounts to approximately 160 GB (state database). Entire database may rise up to 600-650GB.
Although this size increases by around 30 GB each week, certain historical data is retained that is not necessary for
node operation or to maintain a current Ethereum state.</p><p>When Full Pruning is activated and initiated, it conducts a thorough examination of the entire state tree to determine
which data is no longer required and can be treated as historical. It then determines which information corresponds to
the current state, and duplicates it alongside the existing version. During verification of each node in the state, the
new pruned state replaces the previous one. Once the verifier confirms that everything is functioning correctly, the old
state database is eliminated, resulting in significant disk space savings. As a result, the size of the database will be
close to its initial size again.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparation-for-full-pruning">Preparation for Full Pruning<a href="#preparation-for-full-pruning" class="hash-link" aria-label="Direct link to Preparation for Full Pruning" title="Direct link to Preparation for Full Pruning">​</a></h2><p>Because Full Pruning is executed while the node is connected to the network, it can affect the performance of the node.
The process can consume significant amounts of RAM, CPU, and disk resources, which can impact block processing time.
This, in turn, can lead to reduced rewards for Validator setups, particularly for PoS chains.</p><p>Currently, Full Pruning takes between 20 to 30 hours to complete, although the duration may vary based on the user&#x27;s
hardware configuration. To ensure that the process runs smoothly, a minimum of 200 GB of free disk space is required.
However, it&#x27;s recommended to have at least 300 GB or more of free disk space.</p><p>Do not enable Full Pruning on an Archive node, as these are two opposing features. Archive nodes are designed to store
complete historical data, whereas Full Pruning eliminates it. To ensure that Pruning.Mode is disabled for
both <code>InMemory</code> and <code>Full</code>, set the flag <code>Pruning.Mode=None</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-configure-full-pruning">How to configure Full Pruning<a href="#how-to-configure-full-pruning" class="hash-link" aria-label="Direct link to How to configure Full Pruning" title="Direct link to How to configure Full Pruning">​</a></h2><p>As a very first point please review a Pruning configuration options from this documentation
page: <a href="/docs/fundamentals/configuration#pruning">pruning.md</a>.</p><p>To activate the Full Pruning feature, you must set either the <code>Pruning.Mode=Hybrid</code> or <code>Pruning.Mode=Full</code> flag for your
node.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Setting <code>Pruning.Mode=Hybrid</code> enables both <code>InMemory</code> and <code>Full</code> modes. <code>InMemory</code> mode helps the node grow at a slower
rate compared to <code>Pruning.Mode=Full</code>. With this configuration, Full Pruning is executed less frequently, promoting
healthier disk operation. Since Full Pruning is hardware-intensive, this configuration is also beneficial for
attestation results.</p></div></div><p>The next step is to determine the trigger conditions for Full Pruning. Currently, there are three options available:</p><ol><li>Manual</li><li>Size of state database</li><li>Amount of free disk space</li></ol><p>Below is a brief explanation of each option.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-trigger">Manual trigger<a href="#manual-trigger" class="hash-link" aria-label="Direct link to Manual trigger" title="Direct link to Manual trigger">​</a></h3><p>Manual mode enables Full Pruning to be triggered only upon request, providing full control over this functionality. To
configure this mode, add the following flags to your node: <code>--Pruning.Mode=Hybrid --Pruning.FullPruningTrigger=Manual</code>.</p><p>Additionally, you can add an Admin module to your JsonRPC to
execute <a href="/docs/interacting-with-nethermind/json-rpc-api/admin#admin_prune">#admin<!-- -->_<!-- -->prune</a> command. Here&#x27;s how
to do it:</p><ol><li>Add <code>Admin</code> module to <code>EnabledModules</code> on current JsonRpc port (below example - append Admin as last value if you are
overriding it already):\
<code>JsonRpc.EnabledModules=[Eth, Subscribe, Trace, TxPool, Web3, Personal, Proof, Net, Parity, Health, Rpc, Admin]</code></li><li>Create a separate port only for <code>Admin</code> module:\
<code>JsonRpc.AdditionalRpcUrls=http://127.0.0.1:8555|http|admin</code></li></ol><p>Now restart a node and if everything is properly configured, you should be able to
trigger <a href="/docs/interacting-with-nethermind/json-rpc-api/admin#admin_prune">#admin<!-- -->_<!-- -->prune</a> command and Full
Pruning should
be started.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>One potential disadvantage of Manual mode is that if Full Pruning is not triggered in time (due to insufficient disk
space), it cannot be executed. In such cases, the only option to free up disk space would be to resync the node from
scratch.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="size-of-state-database">Size of state database<a href="#size-of-state-database" class="hash-link" aria-label="Direct link to Size of state database" title="Direct link to Size of state database">​</a></h3><p><code>StateDbSize</code> mode enables Full Pruning to be triggered automatically when the state database reaches a specified size.
To enable this mode, add the following
flags: <code>--Pruning.Mode=Hybrid --Pruning.FullPruningTrigger=StateDbSize --Pruning.FullPruningThresholdMb=256000</code>, where
256000 should be set based on current requirements.</p><p>With this configuration, Full Pruning will be triggered automatically whenever the state database size exceeds 256000
MB (250 GB). Since the state database initially has around 160 GB, pruning will be triggered when the database size
grows beyond 90 GB.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>To avoid unexpected behavior and ensure that Full Pruning can be completed in full, it&#x27;s recommended to set the
threshold value to trigger pruning before the free disk space drops below 250 GB as a minimum. This ensures that there
is sufficient free disk space available for the Full Pruning process.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="free-disk-space-left-on-machine">Free disk space left on machine<a href="#free-disk-space-left-on-machine" class="hash-link" aria-label="Direct link to Free disk space left on machine" title="Direct link to Free disk space left on machine">​</a></h3><blockquote><p>This is a recommended approach as it ensures, that pruning will be executed on time</p></blockquote><p><code>VolumeFreeSpace</code> mode allows Full Pruning to be triggered when the amount of free disk space reaches a selected
minimum. To enable this mode, add the following
flags: <code>--Pruning.Mode=Hybrid --Pruning.FullPruningTrigger=VolumeFreeSpace--Pruning.FullPruningThresholdMb=256000</code>,
where 256000 should be set based on current requirements. However, it should never be set below the default value of</p><ol start="256000"><li></li></ol><p>This configuration will trigger Full Pruning whenever the amount of free disk space drops to 250 GB. This ensures that
pruning is invoked as infrequently as possible while also ensuring that there is always sufficient free space available
to trigger it.</p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>It&#x27;s recommended not to set the value below 250 GB for stability reasons. In reality, Full Pruning should require
approximately the same amount of space as a fresh state database (around 160 GB), but it also needs a threshold for
processing and other operations since it creates a copy of the existing state database. Therefore, it&#x27;s essential to
maintain a minimum amount of free disk space to ensure stable and reliable pruning performance.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-progress-of-full-pruning">Monitoring progress of Full Pruning<a href="#monitoring-progress-of-full-pruning" class="hash-link" aria-label="Direct link to Monitoring progress of Full Pruning" title="Direct link to Monitoring progress of Full Pruning">​</a></h2><p>When Full Pruning is triggered correctly, several messages will be visible in the logs of the Nethermind process.</p><p>Very first ones should be:</p><blockquote><p>Full Pruning Ready to start: pruning garbage before state BLOCK<!-- -->_<!-- -->NUMBER with root ROOT<!-- -->_<!-- -->HASH.\
<strong>WARN</strong>: Full Pruning Started on root hash ROOT<!-- -->_<!-- -->HASH: do not close the node until finished or progress will be lost.</p></blockquote><p>From that moment ensure that no restarts will be performed on a node to ensure that Full pruning will be done properly.
After few minutes first logs with progress would start to appear:</p><blockquote><p>Full Pruning In Progress: 00:00:57.0603307 1.00 mln nodes mirrored.\
Full Pruning In Progress: 00:01:40.3677103 2.00 mln nodes mirrored.\
Full Pruning In Progress: 00:02:25.6437030 3.00 mln nodes mirrored.</p></blockquote><p>Pruning may take even <strong>more than 30 hours</strong> (this depends on CPU and IO operations on disk).</p><p>Whenever pruning will be completed, there will be a log message:</p><blockquote><p>Full Pruning Finished: 15:25:59.1620756 1,560.29 mln nodes mirrored.</p></blockquote><p>As you can notice, on this example it took around 15 hours.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Since the amount of mirrored nodes is not a static value, it&#x27;s not possible to provide a simple progress indicator in
percentage. Therefore, the approximate value given should be used to determine when Full Pruning is expected to be
completed.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-settings">Additional settings<a href="#additional-settings" class="hash-link" aria-label="Direct link to Additional settings" title="Direct link to Additional settings">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fullpruningmemorybudgetmb">FullPruningMemoryBudgetMb<a href="#fullpruningmemorybudgetmb" class="hash-link" aria-label="Direct link to FullPruningMemoryBudgetMb" title="Direct link to FullPruningMemoryBudgetMb">​</a></h3><p>The <code>FullPruningMemoryBudgetMb</code> configuration parameter controls the memory budget allocated for the trie visit during
the full pruning process. By increasing this value, the number of required read IOPS (Input/Output Operations Per
Second) can be significantly reduced, which results in a faster full pruning operation. However, this improvement comes
at the expense of increased RAM usage.\
\
Assuming your system has a total of 64GB of RAM, with the application, CL client, and system expenses consuming 20GB,
you need to determine the maximum value for <code>FullPruningMemoryBudgetMb</code> while ensuring that the system remains stable
and respecting the given limit.</p><p>In this case, you have 44GB (64GB - 20GB) of available RAM for increasing the <code>FullPruningMemoryBudgetMb</code> value. To
calculate the maximum value in megabytes, multiply the available RAM by 1024 (since 1GB = 1024MB):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">44GB * 1024MB/GB = 45056MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Setting the <code>FullPruningMemoryBudgetMb</code> value higher than 16GB may not provide any additional performance benefits.</p></div></div><p>However, there is a recommendation that the value of <code>FullPruningMemoryBudgetMb</code> should not be higher than 16GB. So,
considering this guideline, you can set the <code>FullPruningMemoryBudgetMb</code> value to a maximum of 16GB, which is equivalent
to:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">16GB * 1024MB/GB = 16384MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To apply this value, update the configuration file as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pruning.FullPruningMemoryBudgetMb=16384</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please note that this example assumes that the remaining 44GB of RAM is sufficient for the full pruning memory budget.
Depending on the specific use case and system requirements, it may be necessary to further adjust the value to optimize
performance and resource usage.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fullpruningcompletionbehavior">FullPruningCompletionBehavior<a href="#fullpruningcompletionbehavior" class="hash-link" aria-label="Direct link to FullPruningCompletionBehavior" title="Direct link to FullPruningCompletionBehavior">​</a></h3><p>This setting determines the behavior of the node after Full Pruning has completed. By default, the node will continue to
progress as usual. However, if the user wishes to shut down the node after Full Pruning has completed, there are two
options available:</p><ol><li><code>None</code>: No special action will be taken.</li><li><code>ShutdownOnSuccess</code>: Nethermind will shut down if the Full Pruning process is successful.</li><li><code>AlwaysShutdown</code>: Nethermind will shut down once Full Pruning completes, regardless of whether it succeeded or
failed.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fullpruningmaxdegreeofparallelism">FullPruningMaxDegreeOfParallelism<a href="#fullpruningmaxdegreeofparallelism" class="hash-link" aria-label="Direct link to FullPruningMaxDegreeOfParallelism" title="Direct link to FullPruningMaxDegreeOfParallelism">​</a></h3><p>This setting determines the number of parallel tasks and threads that can be used by Full Pruning:</p><ol><li>0: the number of logical processors</li><li>1: Full Pruning will run on a single thread.</li></ol><p>The recommended value depends on the type of node being used. If the node needs to be responsive (e.g., RPC or Validator
node), it&#x27;s recommended to use a value below the number of logical processors. If the node doesn&#x27;t have many other
responsibilities but needs to reliably follow the chain without delays and produce live logs, the default value is
recommended. If the node doesn&#x27;t need to be responsive, has very fast I/O (such as NVME), and the shortest pruning time
is desired, this can be set to 2-3 times the number of logical processors.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="side-notes">Side notes<a href="#side-notes" class="hash-link" aria-label="Direct link to Side notes" title="Direct link to Side notes">​</a></h2><p>During the Full Pruning process, several things should be kept in mind:</p><ol><li>Full Pruning is a very heavy task, but it&#x27;s performed in the background, so the node continues to progress and follow
the chain.</li><li>Due to the heaviness of the task, it may affect validator rewards effectiveness, but since it&#x27;s executed only once
every few months, it shouldn&#x27;t have a significant impact on overall results (we&#x27;ve experienced approximately 5-10%
loss of rewards during Full Pruning).</li><li>Ensure that your disk has at least 250 GB of free space after syncing the node. Otherwise, Full Pruning will never
complete successfully.</li><li>Several things can be done to reduce the size of the database after syncing (such as setting AncientBarriers to a
proper value higher than 0, using CL which requires less disk space, and setting logs to the lowest level to avoid
log spamming).</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/NethermindEth/docs/tree/main/docs/docs/fundamentals/08-how-to-reduce-database-size/full-pruning.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-08-22T15:10:57.000Z">Aug 22, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/fundamentals/how-to-reduce-database-size"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to reduce database size</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/fundamentals/how-to-reduce-database-size/resync-database-from-scratch"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Resync database from scratch</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a></li><li><a href="#preparation-for-full-pruning" class="table-of-contents__link toc-highlight">Preparation for Full Pruning</a></li><li><a href="#how-to-configure-full-pruning" class="table-of-contents__link toc-highlight">How to configure Full Pruning</a><ul><li><a href="#manual-trigger" class="table-of-contents__link toc-highlight">Manual trigger</a></li><li><a href="#size-of-state-database" class="table-of-contents__link toc-highlight">Size of state database</a></li><li><a href="#free-disk-space-left-on-machine" class="table-of-contents__link toc-highlight">Free disk space left on machine</a></li></ul></li><li><a href="#monitoring-progress-of-full-pruning" class="table-of-contents__link toc-highlight">Monitoring progress of Full Pruning</a></li><li><a href="#additional-settings" class="table-of-contents__link toc-highlight">Additional settings</a><ul><li><a href="#fullpruningmemorybudgetmb" class="table-of-contents__link toc-highlight">FullPruningMemoryBudgetMb</a></li><li><a href="#fullpruningcompletionbehavior" class="table-of-contents__link toc-highlight">FullPruningCompletionBehavior</a></li><li><a href="#fullpruningmaxdegreeofparallelism" class="table-of-contents__link toc-highlight">FullPruningMaxDegreeOfParallelism</a></li></ul></li><li><a href="#side-notes" class="table-of-contents__link toc-highlight">Side notes</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/docs/assets/js/runtime~main.8015b15e.js"></script>
<script src="/docs/assets/js/main.2bc10912.js"></script>
</body>
</html>